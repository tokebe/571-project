---
title: "Maps"
output: html_notebook
---

## Processing UFO data

Loading in libraries

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(lubridate)
```

Reading in US data

```{r message=FALSE, warning=FALSE}
ufo_data_us <- read_csv('../data/ufo_data_us_cleaned_v2.csv')
```

Some cleaning

```{r}
# Converting time posted
ufo_data_us$Posted <- as.Date(ufo_data_us$Posted, format = "%m/%d/%y")

# Clean time of sighting (only saves Dates)
ufo_data_us$`Date/Time` <- as.Date(ufo_data_us$`Date/Time`, format = "%m/%d/%y %H:%M")
```

Aggregating UFO data for historical time series

TODO: Do it by state?

- By state

```{r}
historical_data <- ufo_data_us %>% 
  group_by(`Date/Time`) %>% 
  summarize(
    Sightings = n()
  ) %>% 
  drop_na()

# Update years above 2021 to -100 years (assumes in 1900's)
correct_years <- historical_data %>% 
  mutate(`Date/Time` = case_when(
          `Date/Time` > as.POSIXct("2021-04-01 01:00:00") ~ `Date/Time` - years(100),
          TRUE ~ `Date/Time`)
        ) %>% 
  group_by(`Date/Time`) %>% 
  summarize(
    Sightings = sum(Sightings)
  )

# Writes csv
write_csv(correct_years, '../webpage/data/us-historical-sightings.csv')
```

- By city (TODO: fix longitude and latitude)
